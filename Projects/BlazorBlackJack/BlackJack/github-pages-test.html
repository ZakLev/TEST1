<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub Pages Blazor Debug</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
        .test-section { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { background: #e8f5e8; border-left: 4px solid #4caf50; }
        .error { background: #ffebee; border-left: 4px solid #f44336; }
        .info { background: #e3f2fd; border-left: 4px solid #2196f3; }
    </style>
</head>
<body>
    <h1>üîß GitHub Pages Blazor Diagnostic</h1>
    
    <div id="environment-info" class="test-section info">
        <h3>Environment Information</h3>
        <div id="env-details">Loading...</div>
    </div>
    
    <div id="path-tests" class="test-section">
        <h3>Path Resolution Tests</h3>
        <div id="path-results">Testing...</div>
    </div>
    
    <div id="blazor-files" class="test-section">
        <h3>Blazor File Accessibility</h3>
        <div id="file-results">Testing...</div>
    </div>
    
    <div id="recommendations" class="test-section info">
        <h3>Recommendations</h3>
        <div id="rec-content">Analyzing...</div>
    </div>

    <script>
        // Environment detection
        function detectEnvironment() {
            const hostname = window.location.hostname;
            const isGitHubPages = hostname.includes('github.io');
            const isLocalDev = hostname === 'localhost' || hostname === '127.0.0.1';
            
            const envInfo = `
                <strong>Hostname:</strong> ${hostname}<br>
                <strong>Full URL:</strong> ${window.location.href}<br>
                <strong>Protocol:</strong> ${window.location.protocol}<br>
                <strong>Environment:</strong> ${isGitHubPages ? 'GitHub Pages' : isLocalDev ? 'Local Development' : 'Other'}<br>
                <strong>Current Base:</strong> ${document.querySelector('base')?.href || 'None set'}<br>
                <strong>User Agent:</strong> ${navigator.userAgent}
            `;
            
            document.getElementById('env-details').innerHTML = envInfo;
            return { isGitHubPages, isLocalDev, hostname };
        }
        
        // Test path resolution
        async function testPaths(env) {
            const paths = [
                '_framework/blazor.webassembly.js',
                'css/app.css',
                'BlazorApp1.styles.css'
            ];
            
            let results = '<ul>';
            
            for (const path of paths) {
                try {
                    const response = await fetch(path, { method: 'HEAD' });
                    const status = response.ok ? 'success' : 'error';
                    const statusText = response.ok ? '‚úÖ Found' : `‚ùå ${response.status} ${response.statusText}`;
                    results += `<li class="${status}"><strong>${path}:</strong> ${statusText}</li>`;
                } catch (error) {
                    results += `<li class="error"><strong>${path}:</strong> ‚ùå Error: ${error.message}</li>`;
                }
            }
            
            results += '</ul>';
            document.getElementById('path-results').innerHTML = results;
        }
        
        // Test Blazor-specific files
        async function testBlazorFiles() {
            const blazorFiles = [
                '_framework/blazor.boot.json',
                '_framework/dotnet.js'
            ];
            
            let results = '<ul>';
            
            for (const file of blazorFiles) {
                try {
                    const response = await fetch(file);
                    if (response.ok) {
                        const contentType = response.headers.get('content-type');
                        results += `<li class="success"><strong>${file}:</strong> ‚úÖ Available (${contentType})</li>`;
                    } else {
                        results += `<li class="error"><strong>${file}:</strong> ‚ùå ${response.status} ${response.statusText}</li>`;
                    }
                } catch (error) {
                    results += `<li class="error"><strong>${file}:</strong> ‚ùå ${error.message}</li>`;
                }
            }
            
            results += '</ul>';
            document.getElementById('file-results').innerHTML = results;
        }
        
        // Generate recommendations
        function generateRecommendations(env) {
            let recommendations = '<ul>';
            
            if (env.isGitHubPages) {
                recommendations += `
                    <li><strong>For GitHub Pages:</strong> Ensure base href is set to <code>/TEST1/Projects/BlazorBlackJack/BlackJack/</code></li>
                    <li><strong>MIME Types:</strong> GitHub Pages should serve .wasm files correctly, but check browser network tab</li>
                    <li><strong>CORS:</strong> GitHub Pages handles CORS automatically for same-origin requests</li>
                `;
            } else if (env.isLocalDev) {
                recommendations += `
                    <li><strong>For Local Development:</strong> Use relative base href <code>./</code> or no base href</li>
                    <li><strong>Server:</strong> Ensure your local server serves .wasm files with correct MIME type</li>
                `;
            }
            
            recommendations += `
                <li><strong>Fallback:</strong> Consider using standalone HTML/JS version for better compatibility</li>
                <li><strong>Debug:</strong> Check browser console and network tab for specific error messages</li>
            </ul>`;
            
            document.getElementById('rec-content').innerHTML = recommendations;
        }
        
        // Run all tests
        async function runDiagnostics() {
            const env = detectEnvironment();
            await testPaths(env);
            await testBlazorFiles();
            generateRecommendations(env);
        }
        
        // Start diagnostics when page loads
        document.addEventListener('DOMContentLoaded', runDiagnostics);
    </script>
</body>
</html>